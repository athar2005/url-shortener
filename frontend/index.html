<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>URL Shortener</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    /* RESET */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, Helvetica, sans-serif;
    }

    body {
      height: 100vh;
      background: black;
      overflow: hidden;
      color: white;
    }

    /* STAR BACKGROUND */
    .stars {
      position: absolute;
      width: 100%;
      height: 100%;
      background: transparent;
      overflow: hidden;
      z-index: 1;
    }

    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: white;
      opacity: 0.8;
      animation: blink 3s infinite ease-in-out, move 60s linear infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 1; }
    }

    @keyframes move {
      from { transform: translateY(0); }
      to { transform: translateY(-100vh); }
    }

    /* CENTER CARD */
    .container {
      position: relative;
      z-index: 2;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .card {
      background: rgba(20, 20, 20, 0.9);
      padding: 30px;
      border-radius: 16px;
      width: 380px;
      box-shadow: 0 0 25px rgba(255, 255, 255, 0.1);
    }

    .card h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    .card input {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: none;
      outline: none;
    }

    .card button {
      width: 100%;
      padding: 12px;
      background: #4f46e5;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }

    .card button:hover {
      background: #6366f1;
    }
  </style>
</head>
<body>

  <!-- STAR BACKGROUND -->
  <div class="stars" id="stars"></div>

  <!-- MAIN UI -->
  <div class="container">
    <div class="card">
      <h2>üîó URL Shortener</h2>
      <input type="text" placeholder="Paste long URL" />
      <input type="text" placeholder="Custom short name (optional)" />
      <button>Shorten URL</button>
      <div id="result" style="margin-top:15px; text-align:center;"></div>
    </div>
  </div>

  <script>
  const starsContainer = document.getElementById('stars');

  for (let i = 0; i < 120; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.left = Math.random() * 100 + 'vw';
    star.style.top = Math.random() * 100 + 'vh';
    star.style.animationDuration = (Math.random() * 10 + 40) + 's';
    starsContainer.appendChild(star);
  }

  const inputs = document.querySelectorAll("input");
  const button = document.querySelector("button");
  const resultDiv = document.getElementById("result");

  button.addEventListener("click", async () => {
    const longUrl = inputs[0].value;
    const customCode = inputs[1].value;

    if (!longUrl) {
      resultDiv.innerHTML = "<p style='color:red'>Please enter a URL</p>";
      return;
    }

    try {
      const response = await fetch("/shorten", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ longUrl, customCode })
      });

      const data = await response.json();

      if (data.error) {
        resultDiv.innerHTML = `<p style="color:red">${data.error}</p>`;
        return;
      }

resultDiv.innerHTML = `
  <p style="margin-bottom:8px;">
    <strong>Short URL:</strong><br>
    <a id="shortLink" href="${data.shortUrl}" target="_blank" style="color:#8ab4f8">
      ${data.shortUrl}
    </a>
  </p>

  <button id="copyBtn" style="
    margin:6px 0;
    padding:6px 10px;
    border-radius:6px;
    border:none;
    cursor:pointer;
    background:#22c55e;
    color:black;
    font-size:14px;
  ">üìã Copy URL</button>

  <br>

  <img id="qrImg" src="${data.qrCode}" width="150" style="margin-top:10px;" />

  <br>

  <button id="downloadBtn" style="
    margin-top:8px;
    padding:6px 10px;
    border-radius:6px;
    border:none;
    cursor:pointer;
    background:#38bdf8;
    color:black;
    font-size:14px;
  ">‚¨áÔ∏è Download QR</button>
`;
// üìã Copy short URL
document.getElementById("copyBtn").addEventListener("click", () => {
  navigator.clipboard.writeText(data.shortUrl);
  document.getElementById("copyBtn").innerText = "‚úÖ Copied";
});

// ‚¨áÔ∏è Download QR code
document.getElementById("downloadBtn").addEventListener("click", () => {
  const qrImg = document.getElementById("qrImg");
  const link = document.createElement("a");
  link.href = qrImg.src;
  link.download = "qr-code.png";
  link.click();
});

    } catch (err) {
      resultDiv.innerHTML = "<p style='color:red'>Server error</p>";
      console.error(err);
    }
  });
</script>



</body>
</html>
